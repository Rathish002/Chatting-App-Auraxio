/*
    @license

    Packager v0.1.9
    @author baryla (Adrian Barylski)
    @github https://github.com/baryla/packager

    Released under the MIT License.
*/
var Packager=function(){"use strict";var extendStatics=function(e,n){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(e,n)};function __extends(e,n){function t(){this.constructor=e}extendStatics(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}var __assign=function(){return(__assign=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function __awaiter(e,n,t,r){return new(t||(t=Promise))((function(i,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function o(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,o)}u((r=r.apply(e,n||[])).next())}))}function __generator(e,n){var t,r,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=n.call(e,s)}catch(e){a=[6,e],r=0}finally{t=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}function __spreadArrays(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var r=Array(e),i=0;for(n=0;n<t;n++)for(var a=arguments[n],s=0,o=a.length;s<o;s++,i++)r[i]=a[s];return r}
/*
    @license

    Packager Shared libs v0.1.9
    @author baryla (Adrian Barylski)
    @github https://github.com/baryla/packager

    Released under the MIT License.
*/var __assign$1=function(){return(__assign$1=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function __spreadArrays$1(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var r=Array(e),i=0;for(n=0;n<t;n++)for(var a=arguments[n],s=0,o=a.length;s<o;s++,i++)r[i]=a[s];return r}var isObject=function(e){return e&&"object"==typeof e&&e.constructor===Object},cacheFactory=function(){var e=new Map;return{get:function(n){return e.get(n)},getAll:function(){return Array.from(e.entries()).reduce((function(e,n){var t;return __assign$1(__assign$1({},e),((t={})[n[0]]=n[1]||null,t))}),{})},set:function(n,t){return null!=n&&""!=n&&(e.set(n,t),this.has(n))},has:function(e){return Boolean(this.get(e))},update:function(e,n){var t=this.get(e);if(t)return isObject(n)?(this.set(e,__assign$1(__assign$1({},t),n)),this.has(e)):(this.set(e,n),this.has(e))},delete:function(n){return e.delete(n)},clear:function(){e.clear()}}},isModuleExternal=function(e){return!e.startsWith(".")&&!e.startsWith("/")},normalizeBundleOptions=function(e){return{dependencies:convertKeysToLowercase(e.dependencies)}},convertKeysToLowercase=function(e){return e?Object.keys(e||{}).reduce((function(n,t){var r;return __assign$1(__assign$1({},n),((r={})[t.toLowerCase()]=e[t],r))}),{}):{}},parsePackagePath=function(e){var n,t;if(!e||""==e)return{name:null,version:null,path:null};var r=e.startsWith("@")?null===(n=/^(@[^/]+\/[^/@]+)(?:([\s\S]+))?/.exec(e))||void 0===n?void 0:n.slice(1):null===(t=/^([^/@]+)(?:([\s\S]+))?/.exec(e))||void 0===t?void 0:t.slice(1);if(null==r?void 0:r.length){var i=extractRest(r[1]||null);return __assign$1({name:r[0]||null},i)}return{name:null,version:null,path:null}},extractRest=function(e){if(!e||""==e)return{version:null,path:null};if(e.startsWith("@")){var n=/@(.*?)\/(.*)/.exec(e);return n?{version:n[1]||null,path:n[2]||null}:{version:e.substring(1)||null,path:null}}if(e&&~e.indexOf("@")){var t=e.split("@");return{version:t[1],path:0===t[0].indexOf("/")?t[0].substring(1):t[0]}}return{version:null,path:e&&e.startsWith("/")?e.slice(1):null}},absolutePath=/^(?:\/|(?:[A-Za-z]:)?[\\|\/])/,relativePath=/^\.?\.\//;function isAbsolute(e){return absolutePath.test(e)}function isRelative(e){return relativePath.test(e)}function basename(e){return e.split(/(\/|\\)/).pop()}function dirname(e){var n=/(\/|\\)[^\/\\]*$/.exec(e);return n?e.slice(0,-n[0].length)||"/":"."}function extname(e){var n=basename(e);if(!n)return"";var t=/\.[^\.]+$/.exec(n);return t?t[0]:""}function resolve(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=e.shift().split(/[\/\\]/);return e.forEach((function(e){if(isAbsolute(e))t=e.split(/[\/\\]/);else{for(var n=e.split(/[\/\\]/);"."===n[0]||".."===n[0];)".."===n.shift()&&t.pop();t.push.apply(t,n)}})),normalize(t.join("/"))}function normalize(e){return e.replace(/\/\//gi,"/")}var sep="/",path={isAbsolute:isAbsolute,isRelative:isRelative,basename:basename,dirname:dirname,extname:extname,resolve:resolve,normalize:normalize,sep:sep},verifyExtensions=function(e){var n=new RegExp("\\"+e.join("$|\\")+"$","i");return function(e,t){void 0===t&&(t=!0);var r=isModuleExternal(e);return n.test(e)&&!((!r||t)&&r)}},resolveRelative=function(e,n,t,r){if(void 0===r&&(r=!0),!n||""==n)return null;var i=path.resolve(path.dirname(n),e).replace(/^\.\//,""),a=t.files.find((function(e){return e.path===i}));if(a)return r?a.path:a;var s=function(e){return t.files.find((function(n){return n.path===e+"/index.js"||n.path===e+"/index.ts"||n.path===e+"/index.jsx"||n.path===e+"/index.tsx"||n.path===e+".js"||n.path===e+".ts"||n.path===e+".jsx"||n.path===e+".tsx"}))||null}(path.resolve(path.dirname(n),e));return s?r?s.path||null:s||null:null},resolveExternal=function(e,n,t){if(!n.startsWith("@")){if(~n.indexOf("/")){var r=t.dependencies.get(n);if(r){var i=new URL(r.meta.url).pathname;return path.resolve(path.dirname(i),e)}return path.resolve(path.dirname("/"+n),e).replace(/^\.\//,"")}return path.resolve("/"+n,e)}throw new Error("Module "+e+" has a parent "+n+" with @ which is currently not supported.")},fetchScript=function(url){return"function"==typeof self.importScripts?self.importScripts(url):"function"==typeof fetch&&fetch(url).then((function(e){return e.text()})).then((function(text){return eval(text)}))};self.sourceMap||fetchScript("https://cdn.jsdelivr.net/npm/source-map/dist/source-map.js");var generateSourceMap=function(e,n,t){var r=new self.sourceMap.SourceMapGenerator({file:e});return r.setSourceContent(e,n),t.split(/\r?\n/g).forEach((function(n,t){n&&r.addMapping({source:e,original:{line:t+1,column:0},generated:{line:t+1,column:0}})})),r.toJSON()};function deepMerge(){for(var e,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];for(var r={},i=0,a=n;i<a.length;i++){var s=a[i];if(s instanceof Array)r instanceof Array||(r=[]),r=__spreadArrays$1(r,s);else if(s instanceof Object)for(var o=0,u=Object.entries(s);o<u.length;o++){var c=u[o],l=c[0],p=c[1];p instanceof Object&&l in r&&(p=deepMerge(r[l],p)),r=__assign$1(__assign$1({},r),((e={})[l]=p,e))}}return r}self.generateSourceMap=generateSourceMap;var loadRollup=function(){return new Promise((function(e){var n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/rollup@latest/dist/rollup.browser.js",n.setAttribute("data-packager","true"),n.onload=e,document.head.appendChild(n)}))},loadMagicString=function(){return new Promise((function(e){var n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/magic-string@latest/dist/magic-string.umd.min.js",n.setAttribute("data-packager","true"),n.onload=e,document.head.appendChild(n)}))},findEntryFile=function(e,n){var t=e.find((function(e){return e.path===n}))||e.find((function(e){return e.entry}));if(!t)throw Error("You haven't specific an entry file. You can do so by adding 'entry: true' to one of your files or use the 'main' in a package.json file..");return t},extractPackageJsonOptions=function(e){return{dependencies:__assign(__assign({},e.dependencies),e.peerDependencies)}},handleBuildWarnings=function(e){e.code},resolverProxyHook=function(e,n){return new Proxy((function(e,n){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(n){return[2,e]}))}))}),{apply:function(t,r,i){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(a){switch(a.label){case 0:return[4,Reflect.apply(t,n,i)];case 1:if(!a.sent())return[2,Promise.resolve()];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,e.resolver.bind(n)(i[0],i[1])];case 3:return[2,a.sent()||null];case 4:throw r=a.sent(),Error(r);case 5:return[2]}}))}))}})},loaderProxyHook=function(e,n){return new Proxy((function(e){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(n){return[2,e]}))}))}),{apply:function(t,r,i){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,Reflect.apply(t,n,i)];case 1:return r.sent()?[4,e.loader.bind(n)(i[0])]:[2,Promise.resolve()];case 2:return[2,r.sent()||null]}}))}))}})},TransformationException=function(e){function n(n,t){return e.call(this,"Failed to transform "+n+(t?" in "+t:"")+".")||this}return __extends(n,e),n}(Error),TranspilerNotFoundException=function(e){function n(n){return e.call(this,"Transpiler for "+n+" plugin doesn't exist. Make sure you have correctly registered it.")||this}return __extends(n,e),n}(Error),normalizePlugin=function(e){return{name:e.name,transpiler:e.transpiler,extensions:e.extensions,resolver:e.resolver,loader:e.loader,beforeBundle:e.beforeBundle}},MISSING_NAME_FIELD="'name' is a required field on a plugin.",validatePlugin=function(e){if(!e.name)throw new Error(MISSING_NAME_FIELD)},resolver=function(e,n,t){return void 0===n&&(n=1),void 0===t&&(t=3),__awaiter(void 0,void 0,Promise,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e).then((function(e){return __awaiter(void 0,void 0,void 0,(function(){var n;return __generator(this,(function(t){switch(t.label){case 0:return n={},[4,e.text()];case 1:return[2,(n.code=t.sent(),n.meta={url:e.url,status:e.status},n)]}}))}))}))];case 1:return[2,i.sent()];case 2:if(r=i.sent(),404===r.response.status)throw Error("Not found.");if(n<t)return[2,resolver(e,n+1)];throw Error("Error retrieving data.");case 3:return[2]}}))}))},services={unpkg:{url:"https://unpkg.com"},jsdelivr:{url:"https://cdn.jsdelivr.net/npm"}},getNextService=function(e){var n=Object.keys(services),t=n.indexOf(e);return t>=n.length-1?null:n[t+1]};function fetchNpmDependency(e,n,t,r){return void 0===n&&(n="latest"),void 0===t&&(t=""),void 0===r&&(r="unpkg"),__awaiter(this,void 0,Promise,(function(){var i,a,s;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),i=services[r],a=i.url+"/"+e+"@"+n+(""==t||t.startsWith("/")?t:"/"+t),[4,resolver(a)];case 1:return[2,o.sent()];case 2:return o.sent(),(s=getNextService(r))?[2,fetchNpmDependency(e,n,t,s)]:[2,null];case 3:return[2]}}))}))}var enqueue=queueMicrotask;"function"!=typeof enqueue&&(enqueue=function(e){return Promise.resolve().then(e).catch((function(e){return setTimeout((function(){throw e}))}))});var workerQueue=function(){return{currentTask:null,complete:[],errors:[],queue:[],awaiters:[],push:function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){return this.queue.push(e),enqueue(this.next.bind(this)),[2,this.wait()]}))}))},next:function(){return __awaiter(this,void 0,Promise,(function(){var e,n,t;return __generator(this,(function(r){switch(r.label){case 0:if(this.currentTask)return[3,6];e=this.queue.shift(),r.label=1;case 1:return r.trys.push([1,5,,6]),e?(this.currentTask=e,[4,this.currentTask]):[3,3];case 2:return n=r.sent(),this.complete.push(n),this.currentTask=void 0,this.queue.length?enqueue(this.next.bind(this)):this.callAWaiters(),[3,4];case 3:this.callAWaiters(),r.label=4;case 4:return[3,6];case 5:return t=r.sent(),this.errors.push(t),[3,6];case 6:return[2]}}))}))},callAWaiters:function(){this.awaiters.splice(0).forEach((function(e){return e()}))},wait:function(){var e=this;return this.queue.length?new Promise((function(n){return e.awaiters.push(n)})):Promise.resolve()}}},TRANSPILE_STATUS={PREPARE_FILES:"TRANSPILER:FILE:PREPARE",PREPARE_ADDITIONAL:"TRANSPILER:ADDITIONAL:PREPARE",ADDITIONAL_TRANSPILED:"TRANSPILER:ADDITIONAL:TRANSPILED",TRANSPILE_COMPLETE:"TRANSPILER:TRANSPILE:COMPLETE",ERROR_COMPILE:"TRANSPILER:ERROR:COMPILE",ERROR_ADDITIONAL:"TRANSPILER:ERROR:ADDITIONAL"},validateOptions=function(e){if(!e.worker)throw new Error("Every transpiler requires a worker.");if(e.dependencies&&!Array.isArray(e.dependencies)||e.dependencies&&Array.isArray(e.dependencies)&&0===e.dependencies.length)throw new Error("'Dependencies' has to be an array with string values.")},validateContext=function(e){var n=e.meta.get("transpiler");if(!n.extensions||n.extensions&&!Array.isArray(n.extensions)||n.extensions&&Array.isArray(n.extensions)&&!n.extensions.length)throw new Error("Plugin "+e.name+" has to have extensions when using a transpiler.")},createTranspiler=function(e,n){return validateOptions(e),validateContext(n),{context:n,setContext:function(e){this.context=e},worker:e.worker(),extensions:n.meta.get("transpiler").extensions,transpile:function(e){var n=this;return new Promise((function(t,r){n.worker.onmessage=function(e){var i=e.data;return __awaiter(n,void 0,void 0,(function(){var e,n,a,s,o,u;return __generator(this,(function(c){switch(c.label){case 0:if(e=i.file,n=i.type,a=i.error,s=i.additional,n===TRANSPILE_STATUS.ERROR_ADDITIONAL||n===TRANSPILE_STATUS.ERROR_COMPILE)return[2,r(a)];if(n!==TRANSPILE_STATUS.PREPARE_ADDITIONAL)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.transpileAdditional(s)];case 2:return o=c.sent(),this.worker.postMessage({type:TRANSPILE_STATUS.ADDITIONAL_TRANSPILED,file:e,additional:o,context:{files:this.context.packagerContext.files}}),[3,4];case 3:return u=c.sent(),[2,r(u)];case 4:return n===TRANSPILE_STATUS.TRANSPILE_COMPLETE?[2,t(e)]:[2]}}))}))},n.worker.postMessage({type:TRANSPILE_STATUS.PREPARE_FILES,file:e,context:{files:n.context.packagerContext.files}})}))},transpileAdditional:function(e){var n=e.styles;e.html;return __awaiter(this,void 0,void 0,(function(){var e,t,r,i,a,s,o,u,c,l;return __generator(this,(function(p){switch(p.label){case 0:for(e=[],t=0,r=n;t<r.length;t++){if(i=r[t],a=i.code,s=i.path,o=i.name,!(u=i.extension)||""===u)throw console.error("Could not recognise which file type or language to load for "+s),new Error("Could not recognise which file type or language to load for "+s);(c=this.getDependencyTranspiler(u))&&e.push(c.transpile({name:o,code:a,path:s}))}return l={},[4,Promise.all(e)];case 1:return[2,(l.styles=p.sent(),l)]}}))}))},getDependencyTranspiler:function(e){e=e.startsWith(".")?e:"."+e;var n=Object.values(this.context.packagerContext.transpilers.getAll()).find((function(n){return n.extensions.includes(e)}));if(n){var t=__assign(__assign({},n.context),{packagerContext:this.context.packagerContext});return n.setContext(t),n}var r=this.context.packagerContext.plugins.find((function(n){var t=n.meta.get("transpiler");return!!t&&t.extensions.includes(e)}));if(r&&r.rawPlugin.transpiler){t=__assign(__assign({},r),{packagerContext:this.context.packagerContext});return n=createTranspiler(r.rawPlugin.transpiler,t),this.context.packagerContext.transpilers.set(r.name+"-transpiler",n),t.packagerContext=this.context.packagerContext,n.setContext(t),n}throw console.error("Extension "+e+" is not supported. Please register a plugin that supports it."),new Error("Extension "+e+" is not supported. Please register a plugin that supports it.")}}},transformProxyHook=function(e,n){var t=e.name+"-transpiler";return new Proxy((function(r,i){return __awaiter(void 0,void 0,void 0,(function(){var a,s,o;return __generator(this,(function(u){switch(u.label){case 0:return e.transpiler?((a=n.packagerContext.transpilers.get(t))?a.setContext(n):a=createTranspiler(e.transpiler,n),n.packagerContext.transpilers.set(t,a),verifyExtensions(a.extensions)(i)?(s=n.packagerContext.files.find((function(e){return e.path===i})),[4,n.packagerContext.workerQueue.push(a.transpile(__assign(__assign({},s),{code:r})))]):[2,null]):[2,null];case 1:if(u.sent(),o=n.packagerContext.workerQueue.complete.find((function(e){return e.path===i})))return[2,{code:o.code,map:o.map||{mappings:""},moduleId:i}];throw new TransformationException(i,t)}}))}))}),{apply:function(t,r,i){return __awaiter(this,void 0,void 0,(function(){var a,s,o,u;return __generator(this,(function(c){switch(c.label){case 0:return n.packagerContext=__assign(__assign({},n.packagerContext),{acornParser:r.parse}),[4,Reflect.apply(t,n,i)];case 1:return(a=c.sent())?e.beforeBundle?(s=a.code,o=a.map,u=a.moduleId,[2,{code:e.beforeBundle.bind(n)(s,u)||s,map:o}]):[2,a]:[2,Promise.resolve()]}}))}))}})},beforeBundleProxyHook=function(e,n){return new Proxy((function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var r;return __generator(this,(function(i){return(r=function(e){return n.packagerContext.workerQueue.complete.find((function(n){return n.path===e}))}(t))?[2,{code:r.code,map:r.map||{mappings:""},moduleId:t}]:[2,{code:e,map:{mappings:""},moduleId:t}]}))}))}),{apply:function(t,r,i){return __awaiter(this,void 0,void 0,(function(){var a,s,o,u,c;return __generator(this,(function(l){switch(l.label){case 0:return n.packagerContext=__assign(__assign({},n.packagerContext),{acornParser:r.parse}),[4,Reflect.apply(t,n,i)];case 1:return(a=l.sent())?(s=a.code,o=a.map,u=a.moduleId,c={},[4,e.beforeBundle.bind(n)(s,u)]):[2,Promise.resolve()];case 2:return[2,(c.code=l.sent()||s,c.map=o,c)]}}))}))}})},pluginRegistry=new Map,rawPluginRegistry=new Map,transformPluginAsProxy=function(e,n){var t={name:e.name},r=new Map;e.transpiler&&r.set("transpiler",{name:e.name+"-transpiler",extensions:e.extensions||[]});var i={name:e.name,packagerContext:n,rawPlugin:e,meta:r},a=n.plugins.findIndex((function(n){return n.name===e.name}));return i.packagerContext=n,~a?n.plugins[a]=i:n.plugins.push(i),e.resolver&&(t=__assign(__assign({},t),{resolveId:resolverProxyHook(e,i)})),e.loader&&(t=__assign(__assign({},t),{load:loaderProxyHook(e,i)})),i.meta.has("transpiler")&&(t=__assign(__assign({},t),{transform:transformProxyHook(e,i)})),!i.meta.has("transpiler")&&e.beforeBundle&&(t=__assign(__assign({},t),{transform:beforeBundleProxyHook(e,i)})),t},createPluginManager=function(){return{packagerContext:{},setPackagerContext:function(e){this.packagerContext=e},registerPlugin:function(e){validatePlugin(e),pluginRegistry.set(e.name||null,__assign(__assign({},normalizePlugin(e)),{transformed:!1})),rawPluginRegistry.set(e.name||null,normalizePlugin(e))},prepareAndGetPlugins:function(){var e=this;return this.getRegisteredPlugins().map((function(n){if(n.transformed){var t=rawPluginRegistry.get(n.name);if(t)return __assign(__assign({},transformPluginAsProxy(t,e.packagerContext)),{transformed:!0});throw Error("Plugin "+n.name+" has been registered incorrectly.")}var r=transformPluginAsProxy(n,e.packagerContext);return pluginRegistry.set(n.name,__assign(__assign({},r),{transformed:!0})),__assign(__assign({},r),{transformed:!0})}))},getRegisteredPlugins:function(){return Array.from(pluginRegistry.entries()).map((function(e){return __assign({},e[1])}))}}},applyPreCode=function(){return"window.__dependencies = { ...window.__dependencies || {} };"};function intro(e){return{name:"packager::setup::intro",intro:function(){return applyPreCode()}}}var setup=function(e){return[intro()]},createPlugin=function(e){return e},cleanupExternalDependency=function(e){return e.replace(/process.env.NODE_ENV/g,"'development'")},baseLoaderPlugin=createPlugin({name:"base-loader",loader:function(e){var n;return __awaiter(this,void 0,void 0,(function(){var t,r,i,a,s,o;return __generator(this,(function(u){switch(u.label){case 0:if(t=this.packagerContext.files.find((function(n){return n.path===e})),!e||t)return[3,3];if(r=parsePackagePath(e),!(i=null===(n=r.name)||void 0===n?void 0:n.split("__")[0]))throw new Error("There was an issue with loading deps for "+e);return a=r.version||this.packagerContext.bundleOptions.dependencies[i]||"latest",this.packagerContext.dependencies.get(e)?[3,2]:[4,fetchNpmDependency(i,a,r.path||"")];case 1:return(s=u.sent()||"")?(o=cleanupExternalDependency(s.code),this.packagerContext.dependencies.set(e,__assign(__assign({},s),{code:o,name:e})),[2,{code:o}]):[2,null];case 2:return[2,{code:""}];case 3:if(e&&t)return[2,{code:t.code}];u.label=4;case 4:return[2,null]}}))}))}}),baseResolverPlugin=createPlugin({name:"base-resolver",resolver:function(e,n){if(!n)return e;if(isModuleExternal(e))return e;var t=resolveRelative(e,n,this.packagerContext);if(t)return t;if(isModuleExternal(n)){var r=resolveExternal(e,n,this.packagerContext);return r?{id:r.substr(1)}:null}throw new Error("Could not resolve '"+e+"' from '"+n+"'")}}),defaultBundleOptions={dependencies:{}},cache={dependencies:cacheFactory(),transpilers:cacheFactory(),esModulesWithoutDefaultExport:new Set,esModulesWithDefaultExport:new Set},plugins=[];function createPluginFactory(e,n,t){void 0===n&&(n=defaultBundleOptions);var r=__assign(__assign({},cache),{files:e,plugins:plugins,workerQueue:workerQueue(),bundleOptions:normalizeBundleOptions(n)});t.setPackagerContext(r),t.registerPlugin(baseResolverPlugin),t.registerPlugin(baseLoaderPlugin);var i=t.prepareAndGetPlugins();return __spreadArrays(setup(),i)}var pluginManager=createPluginManager(),Packager=function(){function e(e,n,t){void 0===n&&(n={}),void 0===t&&(t={}),this.files=[],this.packagerOptions={cache:!0,sourcemaps:!1},this.bundleOptions={dependencies:{}},this.cachedBundle={modules:[]},this.packagerOptions=__assign(__assign({},this.packagerOptions),e),this.inputOptions=__assign(__assign({},n),{inlineDynamicImports:!0,cache:this.packagerOptions.cache&&this.cachedBundle}),this.outputOptions=__assign(__assign({},t),{format:"iife",sourcemap:!!this.packagerOptions.sourcemaps&&"inline",freeze:!1})}return e.prototype.registerPlugin=function(e){pluginManager.registerPlugin(e)},e.prototype.bundle=function(e,n){return __awaiter(this,void 0,void 0,(function(){var t,r,i,a,s,o,u;return __generator(this,(function(c){switch(c.label){case 0:this.files=e,this.bundleOptions=__assign(__assign({},this.bundleOptions),n),c.label=1;case 1:return c.trys.push([1,7,,8]),this.rollup&&window.rollup?[3,4]:[4,loadRollup()];case 2:return c.sent(),[4,loadMagicString()];case 3:c.sent(),this.rollup=window.rollup,c.label=4;case 4:return t=void 0,(r=this.files.find((function(e){return"/package.json"===e.path})))&&""!=r.code&&(i="string"==typeof r.code?JSON.parse(r.code):r.code,a=extractPackageJsonOptions(i),this.bundleOptions=deepMerge(a,this.bundleOptions||{}),i.main&&(t=findEntryFile(this.files,i.main.startsWith("/")?i.main:"/"+i.main))),t=t||findEntryFile(this.files),this.inputOptions=__assign(__assign({},this.inputOptions),{input:null==t?void 0:t.path,onwarn:handleBuildWarnings,plugins:createPluginFactory(this.files,this.bundleOptions,pluginManager)}),[4,this.rollup.rollup(this.inputOptions)];case 5:return s=c.sent(),this.cachedBundle=this.packagerOptions.cache&&s.cache,[4,s.generate(this.outputOptions)];case 6:return[2,{code:(o=c.sent().output)[0].code+" "+(this.outputOptions.sourcemap&&o[0].map?" \n //# sourceMappingURL="+o[0].map.toUrl():"")}];case 7:return u=c.sent(),console.error(u),[3,8];case 8:return[2]}}))}))},e}();return Packager}();